import{d as K,C as X,p as N,r as d,s as A,c as n,o as l,a as R,k as Y,u,h as H,w as O,b as e,f as c,t as s,F as x,j as V,n as h,B as Q,q as P,e as U,D as W}from"./app-B_Zw6QGP.js";import{_ as Z,g as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-oEio1Vio.js";import{_ as te}from"./SiteLayout.vue_vue_type_script_setup_true_lang-C4QPYVyk.js";import{_ as se}from"./Layout.vue_vue_type_script_setup_true_lang-BEjMiQs6.js";import"./index-7eilHQPG.js";import"./useForwardExpose-C6-hPyV1.js";import"./VisuallyHidden-Cy1sULpD.js";import"./createLucideIcon-CHfYH6pV.js";import"./Heading.vue_vue_type_script_setup_true_lang-FmtfF59k.js";const ae={class:"p-6 space-y-6"},oe={class:"flex items-center justify-between"},ie={class:"text-sm text-muted-foreground"},le={key:0,class:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700"},ne={key:1,class:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700"},re={class:"list-disc pl-5 space-y-1"},de=["value"],ue=["value"],ce={class:"flex items-center gap-2"},me=["disabled"],ve={key:0,class:"mt-4 w-full"},pe={class:"h-2 w-full rounded bg-gray-200"},fe={class:"mt-1 text-xs text-muted-foreground"},ge={key:0,class:"mt-3 text-sm text-red-600"},ye={key:1,class:"mt-3 text-sm text-red-600"},_e=["href"],xe={key:3,class:"space-y-6 relative"},he={class:"flex items-center gap-4"},be=["src"],ke={key:0,class:"relative"},we={class:"analyse-processing-overlay"},Ce={class:"analyse-processing-content"},je={class:"analyse-processing-text"},Se={class:"processing-message"},De={class:"progress-bar-container"},Ve={class:"progress-text"},Pe={class:"analyse-processing-stats"},Ue={key:1,class:"rounded-xl border bg-white p-6 shadow-sm dark:bg-zinc-900"},Ie={class:"flex items-center justify-between"},Ee={class:"mt-4 grid gap-3 sm:grid-cols-2"},Fe={class:"font-medium"},Le={class:"font-medium"},Ne={class:"font-medium"},Re={class:"font-medium"},Oe={class:"font-medium"},Te={class:"font-medium"},Be={class:"font-medium"},Me={class:"font-medium"},ze={class:"mt-6"},qe={class:"mt-2 grid gap-2 sm:grid-cols-2"},Ge={class:"text-muted-foreground"},$e=K({__name:"Verification",props:{remainingUploads:{},cycleResetDate:{},queue:{},atLimit:{type:Boolean},upgradeUrl:{}},setup(T){const f=T,I=X(),B=N(()=>I.props?.auth?.is_admin?Z:te),M=[{title:"Verification",href:"/app/verification"}],b=N(()=>{const a=I.props?.csrf_token;return a||document.querySelector('meta[name="csrf-token"]')?.content||""}),g=d(null),y=d(!1),o=A({image:null,upload_from:"verification",_token:b.value}),k=d(!1),w=d(null),E=d(null),C=d(!1),r=d(null),_=d(null),m=d(0),p=d("Starting analysisâ€¦"),j=d(null),S=[{emoji:"ðŸ‘ï¸",label:"Analyzing visual dataâ€¦"},{emoji:"ðŸ” ",label:"Running OCRâ€¦"},{emoji:"ðŸ—‚ï¸",label:"Matching policy recordsâ€¦"},{emoji:"ðŸ›¡ï¸",label:"Evaluating fraud signalsâ€¦"},{emoji:"âœ…",label:"Finalizing resultsâ€¦"}],F=["#3b82f6","#10b981","#f59e0b","#a855f7","#ef4444"];function z(){g.value?.click()}function q(a){const i=a.target.files?.[0]||null;o.image=i,o.image&&!f.atLimit&&D()}async function D(){if(o.image){_.value=null;try{const a=new FormData;a.append("image",o.image),a.append("upload_from",o.upload_from);const t=await fetch(route("app.verification.upload"),{method:"POST",headers:{"X-CSRF-TOKEN":b.value},body:a});if(!t.ok)throw new Error("Upload failed");const i=await t.json();k.value=!0,w.value=i.url,E.value=i.path,o.reset(),g.value&&(g.value.value=""),C.value=!0,m.value=0,p.value="Uploading imageâ€¦";let v=0;j.value=window.setInterval(()=>{m.value<95&&(m.value+=Math.random()*6+2,m.value>95&&(m.value=95)),p.value=S[Math.min(v,S.length-1)].label,v++},700);const L=await fetch(route("app.verification.verify"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":b.value},body:JSON.stringify({path:E.value})});if(!L.ok)throw new Error("Verification failed");r.value=await L.json(),m.value=100,p.value="Completed"}catch(a){_.value=a?.message||"Something went wrong"}finally{try{j.value&&clearInterval(j.value)}catch{}C.value=!1,setTimeout(()=>{m.value=0,p.value="Starting analysisâ€¦"},600)}}}function G(a){a.preventDefault(),y.value=!1;const t=a.dataTransfer;if(!t||!t.files||!t.files.length)return;const i=t.files[0];o.image=i,o.image&&!f.atLimit&&D()}function $(a){a.preventDefault(),y.value=!0}function J(){y.value=!1}return(a,t)=>(l(),n(x,null,[R(u(H),{title:"Verification"}),(l(),Y(W(B.value),{breadcrumbs:M},{default:O(()=>[R(se,null,{default:O(()=>[e("div",ae,[e("div",oe,[t[0]||(t[0]=e("h1",{class:"text-2xl font-semibold"},"Verification",-1)),e("div",ie,"Remaining: "+s(a.remainingUploads)+" Â· Resets "+s(a.cycleResetDate),1)]),_.value?(l(),n("div",le,s(_.value),1)):c("",!0),Object.keys(u(o).errors).length?(l(),n("div",ne,[e("ul",re,[(l(!0),n(x,null,V(u(o).errors,(i,v)=>(l(),n("li",{key:v},s(i),1))),128))])])):c("",!0),k.value?c("",!0):(l(),n("div",{key:2,class:h(["flex flex-col items-center justify-center rounded border-2 border-dashed p-10 text-center transition-colors",f.atLimit?"opacity-60":"",y.value?"border-primary bg-primary/5":""]),onDragover:$,onDragleave:J,onDrop:G},[t[4]||(t[4]=e("div",{class:"text-lg font-medium"},"Upload a photo for verification",-1)),t[5]||(t[5]=e("div",{class:"mt-1 text-sm text-muted-foreground"},"JPEG, PNG up to 5 MB",-1)),e("form",{class:"mt-4",onSubmit:Q(D,["prevent"])},[e("input",{type:"hidden",name:"upload_from",value:u(o).upload_from},null,8,de),e("input",{type:"hidden",name:"_token",value:u(o)._token},null,8,ue),e("input",{ref_key:"fileInput",ref:g,class:"hidden",type:"file",accept:"image/*",onChange:q},null,544),e("div",ce,[e("button",{type:"button",class:"rounded-md bg-primary px-4 py-2 text-white",disabled:f.atLimit,onClick:z}," Choose file ",8,me)]),t[1]||(t[1]=e("div",{class:"mt-2 text-xs text-muted-foreground"},"or drag & drop an image here",-1)),u(o).progress?(l(),n("div",ve,[e("div",pe,[e("div",{class:"h-2 rounded bg-green-500 transition-all",style:P({width:`${u(o).progress.percentage}%`})},null,4)]),e("div",fe,"Uploading "+s(u(o).progress.percentage)+"%",1)])):c("",!0)],32),u(o).errors.image?(l(),n("div",ge,s(u(o).errors.image),1)):c("",!0),f.atLimit?(l(),n("div",ye,[t[2]||(t[2]=U("You've reached your quota. ",-1)),e("a",{href:a.upgradeUrl,class:"underline"},"Upgrade your plan",8,_e),t[3]||(t[3]=U(". ",-1))])):c("",!0)],34)),k.value?(l(),n("div",xe,[e("div",he,[w.value?(l(),n("img",{key:0,src:w.value,alt:"Uploaded",class:"h-32 w-32 rounded border object-cover"},null,8,be)):c("",!0)]),C.value?(l(),n("div",ke,[e("div",we,[e("div",Ce,[t[7]||(t[7]=e("div",{class:"analyse-processing-animation"},[e("div",{class:"analyse-icon"},"ðŸ“·"),e("div",{class:"analyse-scanning-beam"}),e("div",{class:"analyse-pulse-rings"},[e("div",{class:"pulse-ring ring-1"}),e("div",{class:"pulse-ring ring-2"}),e("div",{class:"pulse-ring ring-3"})])],-1)),e("div",je,[t[6]||(t[6]=e("h3",null,"Insurance Verification",-1)),e("p",Se,s(p.value),1),e("div",De,[e("div",{class:"progress-bar-fill",style:P({width:m.value+"%"})},[e("span",Ve,s(Math.round(m.value))+"%",1)],4)])]),e("div",Pe,[(l(),n(x,null,V(S,(i,v)=>e("div",{key:v,class:h(["stat-item",{active:i.label===p.value}])},[e("span",{class:"icon-badge",style:P({backgroundColor:F[v%F.length]})},s(i.emoji),5),e("span",null,s(i.label.replace("â€¦","")),1)],2)),64))])])])])):c("",!0),r.value?(l(),n("div",Ue,[e("div",Ie,[t[8]||(t[8]=e("h2",{class:"text-lg font-semibold"},"Insurance Verification",-1)),e("span",{class:h(["rounded px-2 py-0.5 text-xs",r.value.verified?"bg-emerald-100 text-emerald-800":"bg-red-100 text-red-800"])},s(r.value.verified?"Verified":"Not verified"),3)]),e("div",Ee,[e("div",null,[t[9]||(t[9]=e("div",{class:"text-xs text-muted-foreground"},"Policy #",-1)),e("div",Fe,s(r.value.policy.policy_number),1)]),e("div",null,[t[10]||(t[10]=e("div",{class:"text-xs text-muted-foreground"},"Provider",-1)),e("div",Le,s(r.value.policy.provider),1)]),e("div",null,[t[11]||(t[11]=e("div",{class:"text-xs text-muted-foreground"},"Insured",-1)),e("div",Ne,s(r.value.policy.insured_name),1)]),e("div",null,[t[12]||(t[12]=e("div",{class:"text-xs text-muted-foreground"},"Coverage",-1)),e("div",Re,s(r.value.policy.coverage),1)]),e("div",null,[t[13]||(t[13]=e("div",{class:"text-xs text-muted-foreground"},"Effective",-1)),e("div",Oe,s(r.value.policy.effective_date),1)]),e("div",null,[t[14]||(t[14]=e("div",{class:"text-xs text-muted-foreground"},"Expires",-1)),e("div",Te,s(r.value.policy.expiration_date),1)]),e("div",null,[t[15]||(t[15]=e("div",{class:"text-xs text-muted-foreground"},"Premium",-1)),e("div",Be,s(r.value.policy.premium)+" "+s(r.value.policy.currency),1)]),e("div",null,[t[16]||(t[16]=e("div",{class:"text-xs text-muted-foreground"},"Status",-1)),e("div",Me,s(r.value.policy.status),1)])]),e("div",ze,[t[17]||(t[17]=e("div",{class:"text-sm font-medium"},"Checks",-1)),e("ul",qe,[(l(!0),n(x,null,V(r.value.checks,(i,v)=>(l(),n("li",{key:v,class:"flex items-center gap-2 text-sm"},[e("span",{class:h(["h-2 w-2 rounded-full",i.status==="passed"||i.status==="clear"?"bg-emerald-500":"bg-red-500"])},null,2),U(" "+s(i.label)+" â€” ",1),e("span",Ge,s(i.status),1)]))),128))])])])):c("",!0)])):c("",!0)])]),_:1})]),_:1}))],64))}}),et=ee($e,[["__scopeId","data-v-456f8160"]]);export{et as default};
